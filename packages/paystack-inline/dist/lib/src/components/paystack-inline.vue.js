"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const o=require("vue"),c=require("vue-router"),v=require("@paystack/inline-js");;/* empty css                   */const b=["disabled"],h=o.defineComponent({__name:"paystack-inline",props:{amount:{},inline:{type:Boolean},hidden:{type:Boolean},tooltip:{},customer:{},btnLabel:{default:"Pay Now"},publicKey:{},dontVerify:{type:Boolean},tooltipIcon:{},verifyCallback:{type:Function,default(){return new Promise(n=>n({status:!0,message:""}))}},initializeCallback:{type:Function,default(){return new Promise(n=>n({message:"",reference:"",authorization_url:""}))}},redirectRoute:{}},emits:["ready","success","verified","canceled","destroyed","error","initialized"],setup(n,{expose:d,emit:m}){const r=m,t=n,y=c.useRoute(),f=c.useRouter(),i=o.ref(!1),s=e=>{i.value=!0;try{t.verifyCallback(e).then(({status:a,message:l})=>{i.value=!1,r("verified",{status:a,message:l}),t.redirectRoute&&f.push(t.redirectRoute)})}catch(a){r("error",a,e)}},u=()=>{i.value=!0;try{t.initializeCallback().then(({reference:e,authorization_url:a,message:l})=>{r("initialized",{reference:e,authorization_url:a,message:l}),t.inline||!a?p(e):a&&setTimeout(()=>{globalThis.location.href=a},3e3)})}catch(e){r("error",e)}},p=(e="")=>new v().newTransaction({key:t.publicKey,email:t.customer.email,amount:t.amount*100,reference:e,firstName:(t.customer.name||t.customer.email).split(" ")[0],lastName:(t.customer.name||t.customer.email).split(" ")[1]||"",metadata:{custom_fields:[{display_name:"Name",variable_name:"Name",value:t.customer.name},{display_name:"Phone Number",variable_name:"Phone Number",value:t.customer.phone}]},onSuccess(a){i.value=!1,r("success",a),t.dontVerify||s(a.reference)},onCancel(){i.value=!1,r("canceled",{reference:e})},onError:a=>{i.value=!1,r("error",a,e)}});return o.watch(()=>y.query.reference,e=>{e&&!t.dontVerify&&s(e)},{immediate:!0}),o.onMounted(()=>{r("ready")}),o.onBeforeUnmount(()=>{r("destroyed")}),d({loading:i}),(e,a)=>o.renderSlot(e.$slots,"default",{initialize:()=>u(),loading:i.value},()=>[o.withDirectives(o.createElementVNode("button",o.mergeProps({class:"pay-button"},e.$attrs,{disabled:i.value,onClick:a[0]||(a[0]=l=>u())}),[o.renderSlot(e.$slots,"button",{loading:i.value},()=>[o.createTextVNode(o.toDisplayString(e.btnLabel),1)])],16,b),[[o.vShow,!e.hidden]])])}});exports.default=h;
