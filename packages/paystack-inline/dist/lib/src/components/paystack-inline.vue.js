"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const r=require("vue"),m=require("vue-router"),b=require("@paystack/inline-js");;/* empty css                   */const h=["disabled"],g={key:0,class:"spinner"},k=r.defineComponent({__name:"paystack-inline",props:r.mergeModels({amount:{},inline:{type:Boolean},hidden:{type:Boolean},tooltip:{},customer:{},btnLabel:{default:"Pay Now"},publicKey:{},dontVerify:{type:Boolean},tooltipIcon:{},redirectRoute:{},verifyCallback:{type:Function,default(){return new Promise(i=>i({status:!0,message:""}))}},initializeCallback:{type:Function,default(){return new Promise(i=>i({message:"",reference:"",authorization_url:""}))}}},{reference:{},referenceModifiers:{}}),emits:r.mergeModels(["ready","success","verified","canceled","destroyed","error","initialized"],["update:reference"]),setup(i,{expose:f,emit:y}){const o=y,u=r.useModel(i,"reference"),n=i,s=m.useRoute(),v=m.useRouter(),a=r.ref(!1),c=e=>{a.value=!0;try{n.verifyCallback(e).then(({status:t,message:l})=>{a.value=!1,o("verified",{status:t,message:l}),u.value=void 0,n.redirectRoute&&v.push(n.redirectRoute)})}catch(t){o("error",t,e)}},d=()=>{a.value=!0;try{n.initializeCallback().then(({reference:e,authorization_url:t,message:l})=>{o("initialized",{reference:e,authorization_url:t,message:l}),n.inline||!t?p(e):t&&setTimeout(()=>{globalThis.location.href=t},3e3)})}catch(e){o("error",e)}},p=(e="")=>new b().newTransaction({key:n.publicKey,email:n.customer.email,amount:n.amount*100,reference:e,firstName:(n.customer.name||n.customer.email).split(" ")[0],lastName:(n.customer.name||n.customer.email).split(" ")[1]||"",metadata:{custom_fields:[{display_name:"Name",variable_name:"Name",value:n.customer.name},{display_name:"Phone Number",variable_name:"Phone Number",value:n.customer.phone}]},onSuccess(t){a.value=!1,o("success",t),n.dontVerify||c(t.reference)},onCancel(){a.value=!1,o("canceled",{reference:e})},onError:t=>{a.value=!1,o("error",t,e)}});return r.watch([u,()=>{var e;return(e=s==null?void 0:s.query)==null?void 0:e.reference}],([e,t])=>{t||(t=e),t&&!n.dontVerify&&c(t)},{immediate:!0}),r.onMounted(()=>{o("ready")}),r.onBeforeUnmount(()=>{o("destroyed")}),f({loading:a}),(e,t)=>r.renderSlot(e.$slots,"default",{initialize:()=>d(),loading:a.value},()=>[r.withDirectives(r.createElementVNode("button",r.mergeProps({class:"pay-button"},e.$attrs,{disabled:a.value,onClick:t[0]||(t[0]=l=>d())}),[r.renderSlot(e.$slots,"button",{loading:a.value},()=>[r.createTextVNode(r.toDisplayString(a.value?"":e.btnLabel)+" ",1),a.value?(r.openBlock(),r.createElementBlock("div",g)):r.createCommentVNode("",!0)])],16,h),[[r.vShow,!e.hidden]])])}});exports.default=k;
