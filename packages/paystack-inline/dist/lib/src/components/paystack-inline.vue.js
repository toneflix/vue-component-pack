"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const o=require("vue"),d=require("vue-router"),b=require("@paystack/inline-js");;/* empty css                   */const h=["disabled"],g={key:0,class:"spinner"},k=o.defineComponent({__name:"paystack-inline",props:o.mergeModels({amount:{},inline:{type:Boolean},hidden:{type:Boolean},tooltip:{},customer:{},btnLabel:{default:"Pay Now"},publicKey:{},dontVerify:{type:Boolean},tooltipIcon:{},redirectRoute:{},verifyCallback:{type:Function,default(){return new Promise(i=>i({status:!0,message:""}))}},initializeCallback:{type:Function,default(){return new Promise(i=>i({message:"",reference:"",authorization_url:""}))}}},{modelValue:{},modelModifiers:{}}),emits:o.mergeModels(["ready","success","verified","canceled","destroyed","error","initialized"],["update:modelValue"]),setup(i,{expose:m,emit:f}){const n=f,s=o.useModel(i,"modelValue"),a=i,y=d.useRoute(),v=d.useRouter(),r=o.ref(!1),u=t=>{r.value=!0;try{a.verifyCallback(t).then(({status:e,message:l})=>{r.value=!1,n("verified",{status:e,message:l}),s.value=void 0,a.redirectRoute&&v.push(a.redirectRoute)})}catch(e){n("error",e,t)}},c=()=>{r.value=!0;try{a.initializeCallback().then(({reference:t,authorization_url:e,message:l})=>{n("initialized",{reference:t,authorization_url:e,message:l}),a.inline||!e?p(t):e&&setTimeout(()=>{globalThis.location.href=e},3e3)})}catch(t){n("error",t)}},p=(t="")=>new b().newTransaction({key:a.publicKey,email:a.customer.email,amount:a.amount*100,reference:t,firstName:(a.customer.name||a.customer.email).split(" ")[0],lastName:(a.customer.name||a.customer.email).split(" ")[1]||"",metadata:{custom_fields:[{display_name:"Name",variable_name:"Name",value:a.customer.name},{display_name:"Phone Number",variable_name:"Phone Number",value:a.customer.phone}]},onSuccess(e){r.value=!1,n("success",e),a.dontVerify||u(e.reference)},onCancel(){r.value=!1,n("canceled",{reference:t})},onError:e=>{r.value=!1,n("error",e,t)}});return o.watch([s,()=>y.query.reference],([t,e])=>{e||(e=t),e&&!a.dontVerify&&u(e)},{immediate:!0}),o.onMounted(()=>{n("ready")}),o.onBeforeUnmount(()=>{n("destroyed")}),m({loading:r}),(t,e)=>o.renderSlot(t.$slots,"default",{initialize:()=>c(),loading:r.value},()=>[o.withDirectives(o.createElementVNode("button",o.mergeProps({class:"pay-button"},t.$attrs,{disabled:r.value,onClick:e[0]||(e[0]=l=>c())}),[o.renderSlot(t.$slots,"button",{loading:r.value},()=>[o.createTextVNode(o.toDisplayString(r.value?"":t.btnLabel)+" ",1),r.value?(o.openBlock(),o.createElementBlock("div",g)):o.createCommentVNode("",!0)])],16,h),[[o.vShow,!t.hidden]])])}});exports.default=k;
