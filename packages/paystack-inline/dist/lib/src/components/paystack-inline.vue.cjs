"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const r=require("vue"),m=require("vue-router"),b=require("@paystack/inline-js");;/* empty css                    */const h=["disabled"],g={key:0,class:"spinner"},k=r.defineComponent({__name:"paystack-inline",props:r.mergeModels({amount:{},inline:{type:Boolean},hidden:{type:Boolean},tooltip:{},customer:{},btnLabel:{default:"Pay Now"},publicKey:{},dontVerify:{type:Boolean},tooltipIcon:{},redirectRoute:{},verifyCallback:{type:Function,default(){return new Promise(i=>i({status:!0,message:""}))}},initializeCallback:{type:Function,default(){return new Promise(i=>i({message:"",reference:"",authorization_url:""}))}}},{reference:{},referenceModifiers:{}}),emits:r.mergeModels(["ready","success","verified","canceled","destroyed","error","initialized"],["update:reference"]),setup(i,{expose:f,emit:y}){const o=y,c=r.useModel(i,"reference"),a=i,s=m.useRoute(),v=m.useRouter(),n=r.ref(!1),d=e=>{n.value=!0;try{a.verifyCallback(e).then(({status:t,message:l})=>{n.value=!1,o("verified",{status:t,message:l}),c.value=void 0,a.redirectRoute&&v.push(a.redirectRoute)})}catch(t){n.value=!1,o("error",t,e)}},u=()=>{n.value=!0;try{a.initializeCallback().then(({reference:e,authorization_url:t,message:l})=>{o("initialized",{reference:e,authorization_url:t,message:l}),a.inline||!t?p(e):t&&setTimeout(()=>{globalThis.location.href=t},3e3)})}catch(e){n.value=!1,o("error",e)}},p=(e="")=>new b().newTransaction({key:a.publicKey,email:a.customer.email,amount:a.amount*100,reference:e,firstName:(a.customer.name||a.customer.email).split(" ")[0],lastName:(a.customer.name||a.customer.email).split(" ")[1]||"",metadata:{custom_fields:[{display_name:"Name",variable_name:"Name",value:a.customer.name},{display_name:"Phone Number",variable_name:"Phone Number",value:a.customer.phone}]},onSuccess(t){n.value=!1,o("success",t),a.dontVerify||d(t.reference)},onCancel(){n.value=!1,o("canceled",{reference:e})},onError:t=>{n.value=!1,o("error",t,e)}});return r.watch([c,()=>{var e;return(e=s==null?void 0:s.query)==null?void 0:e.reference}],([e,t])=>{t||(t=e),t&&!a.dontVerify&&d(t)},{immediate:!0}),r.onMounted(()=>{o("ready")}),r.onBeforeUnmount(()=>{o("destroyed")}),f({loading:n,initializeNewPayment:u}),(e,t)=>r.renderSlot(e.$slots,"default",{initialize:()=>u(),loading:n.value},()=>[r.withDirectives(r.createElementVNode("button",r.mergeProps({class:"pay-button"},e.$attrs,{disabled:n.value,onClick:t[0]||(t[0]=l=>u())}),[r.renderSlot(e.$slots,"button",{loading:n.value},()=>[r.createTextVNode(r.toDisplayString(n.value?"":e.btnLabel)+" ",1),n.value?(r.openBlock(),r.createElementBlock("div",g)):r.createCommentVNode("",!0)])],16,h),[[r.vShow,!e.hidden]])])}});exports.default=k;
