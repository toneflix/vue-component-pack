"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),E=require("dayjs"),r=require("../utils/providers.cjs"),k=require("./TBtn.vue.cjs"),M=require("./dialog/TCard.vue.cjs"),b=require("./dialog/TDialog.vue.cjs"),D=require("./TInnerLoading.vue.cjs"),N=require("@toneflix/vue-forms"),C={class:"card-title"},q={class:"q-pa-md"},S={class:"block q-mb-xs"},h={key:2,class:"q-pa-sm"},$={class:"t-list",separator:""},A={class:"t-item-section avatar"},U={class:"t-avatar"},x=["src"],j={class:"t-item-section"},T={class:"t-item-label caption"},F={key:0,class:"t-item-label"},O={key:1,class:"t-item-label"},Y={key:3,class:"img-preview"},L=["src"],P=e.defineComponent({name:"DataViewer",__name:"data-viewer",props:e.mergeModels({exclusions:{default:()=>["id","user","imageUrl","createdAt","updatedAt"]},formExclusions:{default:()=>["id","user","imageUrl","createdAt","updatedAt"]}},{data:{},dataModifiers:{},form:{default:{}},formModifiers:{},mode:{default:"view"},modeModifiers:{},loading:{type:Boolean,default:!1},loadingModifiers:{},saving:{type:Boolean,default:!1},savingModifiers:{},errors:{default:{}},errorsModifiers:{}}),emits:e.mergeModels(["toggleDialog","dataUpdated","click:save"],["update:data","update:form","update:mode","update:loading","update:saving","update:errors"]),setup(n,{emit:_}){const d=_,a=e.useModel(n,"data"),i=e.useModel(n,"form"),v=n,s=e.useModel(n,"mode"),w=e.useModel(n,"loading"),y=e.useModel(n,"saving"),c=e.useModel(n,"errors"),m=e.ref(!1),p=e.computed(()=>a.value?Object.entries(a.value).filter(t=>s.value==="edit"?![...v.exclusions,...v.formExclusions].includes(t[0]):!v.exclusions.includes(t[0])):[]),V=e.computed(()=>p.value.map(([t,l])=>({col:12,name:t,type:typeof l=="boolean"?"radio":"text",label:r.titleCase(r.slug(t," ")),choices:[{label:"Accept",value:!0},{label:"Reject",value:!0}]}))),g=(t,l="view")=>{a.value=t,s.value=l,m.value=!0;const u=Object.fromEntries(Object.entries(t).map(([o,B])=>[r.slug(o),f(B)]));d("toggleDialog",u,l)},f=(t,l)=>l&&l.includes("edAt",l.length-4)?E(String(t)).format("Do MMM, YYYY h:MM A"):typeof t=="boolean"?Number(t):Array.isArray(t)&&t.every(u=>typeof u=="string")&&s.value==="view"?r.titleCase(t.join(", ")):t;return e.watch(a,t=>{t&&d("dataUpdated",t)},{immediate:!0}),(t,l)=>{const u=e.resolveComponent("q-chip");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.renderSlot(t.$slots,"default",{viewData:a.value,viewMode:s.value,toggleDialog:g},void 0,!0),e.createVNode(b.default,e.mergeProps({modelValue:m.value,"onUpdate:modelValue":l[7]||(l[7]=o=>m.value=o)},t.$attrs),{default:e.withCtx(()=>[e.createVNode(M.default,null,{header:e.withCtx(()=>[e.createElementVNode("div",C,e.toDisplayString({view:"View Data",edit:"Edit Data",doc:"View Document"}[s.value||"view"]),1)]),default:e.withCtx(()=>[e.createElementVNode("div",q,[s.value==="edit"?(e.openBlock(),e.createBlock(e.unref(N.VueForms),{key:0,rounded:"",loading:"","show-group-labels":"",class:"p-4 m-4 mx-auto",fields:V.value,modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=o=>i.value=o),onCancel:l[1]||(l[1]=o=>s.value="view"),onSubmit:l[2]||(l[2]=o=>d("click:save",a.value))},null,8,["fields","modelValue"])):e.createCommentVNode("",!0),s.value==="edit"?(e.openBlock(),e.createElementBlock("form",{key:1,class:"q-gutter-md",onSubmit:l[4]||(l[4]=e.withModifiers(()=>{},["prevent"]))},[e.renderSlot(t.$slots,"form-prepend",{form:i.value,errors:c.value,viewData:a.value},void 0,!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,o=>(e.openBlock(),e.createElementBlock("div",{class:"input_wrap",key:o[0]},[e.createElementVNode("label",S,e.toDisplayString(e.unref(r.titleCase)(e.unref(r.slug)(o[0]," "))),1),e.renderSlot(t.$slots,"form-field-append",{form:i.value,value:i.value[e.unref(r.slug)(o[0],"_")],error:!!c.value[e.unref(r.slug)(o[0],"_")],viewData:a.value,errorMessage:c.value[e.unref(r.slug)(o[0],"_")]},void 0,!0)]))),128)),e.renderSlot(t.$slots,"form-append",{form:i.value,errors:c.value,viewData:a.value},void 0,!0),e.createVNode(k.default,{dense:"",color:"primary",label:"Save","icon-right":"fas fa-check",loading:y.value,onClick:l[3]||(l[3]=o=>d("click:save",a.value))},null,8,["loading"])],32)):s.value==="view"&&a.value?(e.openBlock(),e.createElementBlock("div",h,[e.createElementVNode("div",$,[a.value.imageUrl?(e.openBlock(),e.createElementBlock("div",{key:0,class:"q-my-sm t-item clickable",onClick:l[5]||(l[5]=o=>g(a.value,"doc"))},[e.createElementVNode("div",A,[e.createElementVNode("div",U,[e.createElementVNode("img",{src:a.value.imageUrl,alt:"Document"},null,8,x)])]),l[8]||(l[8]=e.createElementVNode("div",{class:"t-item-section"},[e.createElementVNode("div",{class:"t-item-label"},"Click to expand")],-1))])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,o=>(e.openBlock(),e.createElementBlock("div",{class:"q-my-sm t-item",key:o[0]},[e.createElementVNode("div",j,[e.createElementVNode("div",T,e.toDisplayString(e.unref(r.titleCase)(e.unref(r.slug)(o[0]))),1),typeof o[1]=="boolean"?(e.openBlock(),e.createElementBlock("div",F,[e.createVNode(u,{square:"","text-color":"white",color:o[1]?"green":"red "},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o[1]?"Approved":"Pending "),1)]),_:2},1032,["color"])])):(e.openBlock(),e.createElementBlock("div",O,e.toDisplayString(f(o[1],o[0])),1))])]))),128)),e.renderSlot(t.$slots,"list-append",{viewData:a.value},void 0,!0)]),e.renderSlot(t.$slots,"list-after",{viewData:a.value},void 0,!0)])):a.value?(e.openBlock(),e.createElementBlock("div",Y,[e.createVNode(k.default,{dense:"",color:"primary",label:"Return",icon:"fas fa-arrow-left",onClick:l[6]||(l[6]=o=>g(a.value,"view"))}),a.value.imageUrl?(e.openBlock(),e.createElementBlock("img",{key:0,style:{width:"100%"},src:a.value.imageUrl,alt:"Document"},null,8,L)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)]),e.createVNode(D.default,{showing:w.value},null,8,["showing"])]),_:3})]),_:3},16,["modelValue"])],64)}}});exports.default=P;
