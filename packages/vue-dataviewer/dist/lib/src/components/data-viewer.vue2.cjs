"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),M=require("dayjs"),r=require("../utils/providers.cjs"),y=require("./TBtn.vue.cjs"),D=require("./dialog/TCard.vue.cjs"),N=require("./dialog/TDialog.vue.cjs"),C=require("./TInnerLoading.vue.cjs"),k=require("@toneflix/vue-forms"),q={class:"card-title"},h={class:"q-pa-md"},S={class:"block q-mb-xs"},U={key:0,class:"items-center justify-start row q-pr-sm active-grey input-box"},$={key:2,class:"q-pa-sm"},A={class:"t-list",separator:""},x={class:"t-item-section avatar"},j={class:"t-avatar"},F=["src"],T={class:"t-item-section"},L={class:"t-item-label caption"},O={key:0,class:"t-item-label"},P={key:1,class:"t-item-label"},Y={key:3,class:"img-preview"},I=["src"],R=e.defineComponent({name:"DataViewer",__name:"data-viewer",props:e.mergeModels({exclusions:{default:()=>["id","user","imageUrl","createdAt","updatedAt"]},formExclusions:{default:()=>["id","user","imageUrl","createdAt","updatedAt"]}},{data:{},dataModifiers:{},form:{default:{}},formModifiers:{},mode:{default:"view"},modeModifiers:{},loading:{type:Boolean,default:!1},loadingModifiers:{},saving:{type:Boolean,default:!1},savingModifiers:{},errors:{default:{}},errorsModifiers:{}}),emits:e.mergeModels(["toggleDialog","dataUpdated","click:save"],["update:data","update:form","update:mode","update:loading","update:saving","update:errors"]),setup(u,{emit:V}){const m=V,a=e.useModel(u,"data"),n=e.useModel(u,"form"),v=u,s=e.useModel(u,"mode"),w=e.useModel(u,"loading"),B=e.useModel(u,"saving"),d=e.useModel(u,"errors"),p=e.ref(!1),g=e.computed(()=>a.value?Object.entries(a.value).filter(l=>s.value==="edit"?![...v.exclusions,...v.formExclusions].includes(l[0]):!v.exclusions.includes(l[0])):[]),E=e.computed(()=>g.value.map(([l,o])=>({col:12,name:l,type:typeof o=="boolean"?"radio":"text",label:r.titleCase(r.slug(l," ")),choices:{Accept:!0,Reject:!1}}))),f=(l,o="view")=>{a.value=l,s.value=o,p.value=!0;const c=Object.fromEntries(Object.entries(l).map(([t,i])=>[r.slug(t),_(i)]));m("toggleDialog",c,o)},_=(l,o)=>o&&o.includes("edAt",o.length-4)?M(String(l)).format("Do MMM, YYYY h:MM A"):typeof l=="boolean"?Number(l):Array.isArray(l)&&l.every(c=>typeof c=="string")&&s.value==="view"?r.titleCase(l.join(", ")):l;return e.watch(a,l=>{l&&m("dataUpdated",l)},{immediate:!0}),(l,o)=>{const c=e.resolveComponent("q-chip");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.renderSlot(l.$slots,"default",{viewData:a.value,viewMode:s.value,toggleDialog:f},void 0,!0),e.createVNode(N.default,e.mergeProps({modelValue:p.value,"onUpdate:modelValue":o[7]||(o[7]=t=>p.value=t)},l.$attrs),{default:e.withCtx(()=>[e.createVNode(D.default,null,{header:e.withCtx(()=>[e.createElementVNode("div",q,e.toDisplayString({view:"View Data",edit:"Edit Data",doc:"View Document"}[s.value||"view"]),1)]),default:e.withCtx(()=>[e.createElementVNode("div",h,[s.value==="edit"?(e.openBlock(),e.createBlock(e.unref(k.VueForms),{key:0,rounded:"",loading:"","show-group-labels":"",class:"p-4 m-4 mx-auto",fields:E.value,modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=t=>n.value=t),onCancel:o[1]||(o[1]=t=>s.value="view"),onSubmit:o[2]||(o[2]=t=>m("click:save",a.value))},null,8,["fields","modelValue"])):e.createCommentVNode("",!0),s.value==="edit"?(e.openBlock(),e.createElementBlock("form",{key:1,class:"q-gutter-md",onSubmit:o[4]||(o[4]=e.withModifiers(()=>{},["prevent"]))},[e.renderSlot(l.$slots,"form-prepend",{form:n.value,errors:d.value,viewData:a.value},void 0,!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,t=>(e.openBlock(),e.createElementBlock("div",{class:"input_wrap",key:t[0]},[e.createElementVNode("label",S,e.toDisplayString(e.unref(r.titleCase)(e.unref(r.slug)(t[0]," "))),1),typeof t[1]=="boolean"?(e.openBlock(),e.createElementBlock("div",U,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList([0,1],i=>e.createVNode(e.unref(k.InputRadio),{modelValue:n.value[e.unref(r.slug)(t[0],"_")],"onUpdate:modelValue":b=>n.value[e.unref(r.slug)(t[0],"_")]=b,type:"radio",key:i,val:i,name:e.unref(r.slug)(t[0],"_"),label:["Pending","Approved"][i]},null,8,["modelValue","onUpdate:modelValue","val","name","label"])),64))])):(e.openBlock(),e.createBlock(e.unref(k.InputField),{key:1,type:"text",modelValue:n.value[e.unref(r.slug)(t[0],"_")],"onUpdate:modelValue":i=>n.value[e.unref(r.slug)(t[0],"_")]=i,error:!!d.value[e.unref(r.slug)(t[0],"_")],name:e.unref(r.slug)(t[0],"_"),"error-message":d.value[e.unref(r.slug)(t[0],"_")]},null,8,["modelValue","onUpdate:modelValue","error","name","error-message"])),e.renderSlot(l.$slots,"form-field-append",{form:n.value,value:n.value[e.unref(r.slug)(t[0],"_")],error:!!d.value[e.unref(r.slug)(t[0],"_")],viewData:a.value,errorMessage:d.value[e.unref(r.slug)(t[0],"_")]},void 0,!0)]))),128)),e.renderSlot(l.$slots,"form-append",{form:n.value,errors:d.value,viewData:a.value},void 0,!0),e.createVNode(y.default,{dense:"",color:"primary",label:"Save","icon-right":"fas fa-check",loading:B.value,onClick:o[3]||(o[3]=t=>m("click:save",a.value))},null,8,["loading"])],32)):s.value==="view"&&a.value?(e.openBlock(),e.createElementBlock("div",$,[e.createElementVNode("div",A,[a.value.imageUrl?(e.openBlock(),e.createElementBlock("div",{key:0,class:"q-my-sm t-item clickable",onClick:o[5]||(o[5]=t=>f(a.value,"doc"))},[e.createElementVNode("div",x,[e.createElementVNode("div",j,[e.createElementVNode("img",{src:a.value.imageUrl,alt:"Document"},null,8,F)])]),o[8]||(o[8]=e.createElementVNode("div",{class:"t-item-section"},[e.createElementVNode("div",{class:"t-item-label"},"Click to expand")],-1))])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,t=>(e.openBlock(),e.createElementBlock("div",{class:"q-my-sm t-item",key:t[0]},[e.createElementVNode("div",T,[e.createElementVNode("div",L,e.toDisplayString(e.unref(r.titleCase)(e.unref(r.slug)(t[0]))),1),typeof t[1]=="boolean"?(e.openBlock(),e.createElementBlock("div",O,[e.createVNode(c,{square:"","text-color":"white",color:t[1]?"green":"red "},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t[1]?"Approved":"Pending "),1)]),_:2},1032,["color"])])):(e.openBlock(),e.createElementBlock("div",P,e.toDisplayString(_(t[1],t[0])),1))])]))),128)),e.renderSlot(l.$slots,"list-append",{viewData:a.value},void 0,!0)]),e.renderSlot(l.$slots,"list-after",{viewData:a.value},void 0,!0)])):a.value?(e.openBlock(),e.createElementBlock("div",Y,[e.createVNode(y.default,{dense:"",color:"primary",label:"Return",icon:"fas fa-arrow-left",onClick:o[6]||(o[6]=t=>f(a.value,"view"))}),a.value.imageUrl?(e.openBlock(),e.createElementBlock("img",{key:0,style:{width:"100%"},src:a.value.imageUrl,alt:"Document"},null,8,I)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)]),e.createVNode(C.default,{showing:w.value},null,8,["showing"])]),_:3})]),_:3},16,["modelValue"])],64)}}});exports.default=R;
