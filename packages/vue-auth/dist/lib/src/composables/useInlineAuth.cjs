"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("vue"),F=require("../utils/plugins.cjs"),I=require("../stores/vue-auth.cjs"),d=require("../utils/config.cjs"),T=require("pinia"),U=h=>{const v=I.createVueAuthStore(h)(),m=g=>{const l=r.ref(),u=r.ref();return{send:async()=>{const s=await g();return s.error&&l.value?l.value(s.error):!s.error&&u.value&&u.value(s),s},onError:s=>{l.value=s},onSuccess:s=>{u.value=s}}},k=(g,l=d.getAuthConfig())=>{const u=r.ref(),o=r.ref(),a=r.ref(),n=r.ref(!1),s=r.ref(),i=async()=>{n.value=!0;const e=await v.login(g,l);u.value=e.user,o.value=e.error,a.value=e.token,s.value=e.message,n.value=!1;const S={user:e.user,message:e.message,token:e.token,loading:!1};return e.error&&(S.error=e.error),S},{send:f,onError:t,onSuccess:c}=m(i);return{send:f,user:u,token:a,error:o,loading:n,message:s,onError:t,onSuccess:c}},A=(g,l=d.getAuthConfig())=>{const u=r.ref(),o=r.ref(),a=r.ref(),n=r.ref(!1),s=r.ref(),i=async()=>{n.value=!0;const e=await v.register(g,l);return u.value=e.user,o.value=e.error,a.value=e.token,s.value=e.message,n.value=!1,{user:e.user,error:e.error,token:e.token,message:e.message,loading:n.value}},{send:f,onError:t,onSuccess:c}=m(i);return{send:f,user:u,token:a,error:o,loading:n,message:s,onError:t,onSuccess:c}},w=(g=d.getAuthConfig(),l)=>{const u=r.ref(),o=r.ref(!1),a=r.ref(),n=async()=>{o.value=!0;const t=await v.logout(g,l);return u.value=t==null?void 0:t.error,a.value=t==null?void 0:t.message,o.value=!1,{error:t==null?void 0:t.error,message:t==null?void 0:t.message,loading:o.value}},{send:s,onError:i,onSuccess:f}=m(n);return{send:s,error:u,loading:o,message:a,onError:i,onSuccess:f}},C=(g,l=d.getAuthConfig())=>{const u=r.ref(),o=r.ref(!1),a=r.ref(),n=r.ref(),s=r.ref(0),i=async()=>{o.value=!0;const e=await v.forgot(g,l);return u.value=e==null?void 0:e.error,a.value=e==null?void 0:e.message,n.value=e.timeout,o.value=!1,F.createCountdown(n,S=>{s.value=S}),{error:e.error,loading:o.value,message:e.message,timeout:e.timeout,countdown:s.value}},{send:f,onError:t,onSuccess:c}=m(i);return{send:f,error:u,loading:o,message:a,timeout:n,onError:t,onSuccess:c,countdown:s}},y=(g,l=d.getAuthConfig())=>{const u=r.ref(),o=r.ref(),a=r.ref(!1),n=r.ref(),s=async()=>{a.value=!0;const c=await v.reset(g,l);return u.value=c.user,o.value=c==null?void 0:c.error,n.value=c==null?void 0:c.message,a.value=!1,{error:c.error,message:c.message,user:u.value,loading:a.value}},{send:i,onError:f,onSuccess:t}=m(s);return{send:i,user:u,error:o,loading:a,message:n,onError:f,onSuccess:t}},E=(g=d.getAuthConfig(),l,u)=>{const o=r.ref(),a=r.ref(),n=r.ref(!1),s=r.ref(),i=async()=>{n.value=!0;const e=await v.loadUserFromStorage(g,l,u);return o.value=e.user,a.value=e==null?void 0:e.error,s.value=e==null?void 0:e.message,n.value=!1,{error:e.error,message:e.message,user:o.value,loading:n.value}},{send:f,onError:t,onSuccess:c}=m(i);return{send:f,user:o,error:a,loading:n,message:s,onError:t,onSuccess:c}},{user:b,token:q,isAuthenticated:p}=T.storeToRefs(v);return{user:b,token:q,isAuthenticated:p,reset:y,login:k,logout:w,forgot:C,register:A,loadUserFromStorage:E}};exports.useInlineAuth=U;
