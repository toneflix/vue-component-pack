"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const g=(r,e)=>JSON.stringify(r)===JSON.stringify(e),d=(r,e,t)=>{try{const s=t?t.resolve(e):e;return typeof s=="string"?r.path===s:r.path===s.path&&g(r.query,s.query)}catch{return!1}},m=r=>(e,t,s,u,i)=>{if(!u.isAuthenticated&&!d(e,r,i)&&e.meta.requiresAuth)return s(r);s()},o=r=>(e,t,s,u,i)=>{if(u.isAuthenticated&&!d(e,r,i)&&e.meta.requiresGuest)return s(r);s()},y=(r,e,t="roles",s="requiresAdmin")=>(u,i,n,a,l)=>{if(!a.user[t])return n();const f=Array.isArray(a.user[t])?a.user[t]:[String(a.user[t])],h=typeof e=="string"?[e]:e;if(!f.some(c=>h.includes(c))&&!d(u,r,l)&&u.meta[s])return n(r);n()};exports.authMiddleware=m;exports.guestMiddleware=o;exports.roleMiddleware=y;
